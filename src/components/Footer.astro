---
import { minecraftGilde } from '../config/minecraftGilde';
import { FOOTER_COPY, FOOTER_LINKS } from '../data/footer';
import { getRepoInfo } from '../lib/repoInfo';
import FooterLinkGroup from './footer/FooterLinkGroup.astro';
import NavItem from './nav/NavItem.astro';

const year = new Date().getFullYear();
const repoInfo = getRepoInfo({
  configRepoUrl: minecraftGilde.repoUrl,
  envRepoUrl: import.meta.env.GIT_REPO_URL,
  commitHash: import.meta.env.GIT_COMMIT_HASH,
});
---

<footer class="w-full">
  <div class="border-border/70 bg-surface/60 border-t backdrop-blur-md">
    <div class="mx-auto max-w-6xl px-4 py-10">
      <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
        <div class="text-muted text-sm">
          &copy; {year}
          <span class="text-fg/90 font-medium">{FOOTER_COPY.owner}</span>
          <span class="text-fg/60"> &middot; {FOOTER_COPY.brand}</span>
        </div>

        <div class="flex flex-col gap-2 sm:items-end">
          <FooterLinkGroup
            links={FOOTER_LINKS}
            class="flex flex-wrap gap-x-4 gap-y-2 text-sm sm:justify-end"
            linkClass="text-fg/80 hover:text-fg hover:decoration-accent/60 underline decoration-transparent underline-offset-4 transition-colors"
          />

          {
            repoInfo.repoUrl ? (
              <div class="text-fg/60 text-xs sm:text-right">
                <NavItem
                  href={repoInfo.repoUrl}
                  external
                  class="hover:text-fg hover:decoration-accent/50 underline decoration-transparent underline-offset-4 transition-colors"
                >
                  {repoInfo.repoLabel}
                </NavItem>

                {repoInfo.showCommit ? (
                  <>
                    <span aria-hidden="true"> {' @ '} </span>
                    {repoInfo.commitHref ? (
                      <NavItem
                        href={repoInfo.commitHref}
                        external
                        class="hover:text-fg hover:decoration-accent/50 underline decoration-transparent underline-offset-4 transition-colors"
                      >
                        {repoInfo.shortCommit || repoInfo.commitHash}
                      </NavItem>
                    ) : (
                      <span>{repoInfo.shortCommit || repoInfo.commitHash}</span>
                    )}
                  </>
                ) : null}
              </div>
            ) : null
          }
        </div>
      </div>

      <p class="text-muted mt-4 text-xs">
        {FOOTER_COPY.disclaimer}
      </p>
    </div>
  </div>
</footer>
