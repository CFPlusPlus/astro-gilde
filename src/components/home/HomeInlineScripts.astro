---
// Home-spezifische Scripts
// - /public/js/app-home.js: Player-Liste, World-Age, Galerie
// - Inline: Reveal-Animationen (IntersectionObserver)
---

<script src="/js/app-home.js" defer></script>

<script is:inline>
  // Subtiles Reveal (IntersectionObserver) – ohne extra Libraries.
  // Respektiert prefers-reduced-motion und bleibt auf der Startseite scoped.
  (() => {
    try {
      const root = document.querySelector('[data-home]');
      if (!root) return;

      const reduce = window.matchMedia?.('(prefers-reduced-motion: reduce)')?.matches;
      const els = Array.from(root.querySelectorAll('[data-reveal]'));

      if (reduce) {
        els.forEach((el) => el.classList.add('is-revealed'));
        return;
      }

      const io = new IntersectionObserver(
        (entries) => {
          for (const entry of entries) {
            if (!entry.isIntersecting) continue;

            const el = entry.target;
            const delayAttr = el.getAttribute('data-reveal-delay');

            if (delayAttr) {
              const delay = Number.parseInt(delayAttr, 10);
              if (!Number.isNaN(delay) && delay > 0) {
                el.style.setProperty('--reveal-delay', `${delay}ms`);
              }
            }

            el.classList.add('is-revealed');
            io.unobserve(el);
          }
        },
        {
          threshold: 0.12,
          rootMargin: '0px 0px -10% 0px',
        },
      );

      els.forEach((el) => io.observe(el));
    } catch {
      // Falls etwas schiefgeht: keine harte Abhängigkeit, Seite bleibt vollständig nutzbar.
    }
  })();
</script>
