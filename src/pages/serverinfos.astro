---
import BaseLayout from '../layouts/BaseLayout.astro';
import Button from '../components/ui/Button.astro';
import Badge from '../components/ui/Badge.astro';
import Callout from '../components/ui/Callout.astro';
import JsonLd from '../components/seo/JsonLd.astro';
import { buildArticle, buildGameServer } from '../lib/structuredData';
import { Cpu, Shield, Gamepad2, Copy, Map, ArrowRight } from '@lucide/astro';
import { canonicalFor, site } from '../config/site';
import { minecraftGilde } from '../config/minecraftGilde';

const DISCORD_URL = minecraftGilde.discord.url;
const DYNMAP_URL = minecraftGilde.mapUrl;
const SERVER_IP = minecraftGilde.serverIp;
const MC_VERSION = minecraftGilde.mcVersion;

const canonicalUrl = canonicalFor(Astro.url.pathname);
const gameServerLd = buildGameServer({
  site,
  canonicalUrl,
  ip: SERVER_IP,
  port: 25565,
  version: MC_VERSION,
  maxPlayers: 100,
});

const articleLd = buildArticle({
  site,
  canonicalUrl,
  type: 'TechArticle',
  headline: 'Serverinfos & Folia-Setup – Minecraft Gilde (Vanilla SMP 1.21.x)',
  description:
    'Technische Details zum Setup der Minecraft Gilde: Folia 1.21.x, Hardware & Kernfeatures – optimiert für Vanilla Survival & Freebuild ohne Pay2Win.',
  image: new URL('/images/logo.webp', site).toString(),
  authorName: 'Christian Falkner',
  authorUrl: 'https://www.falkner.info',
  articleSection: 'Serverinformationen',
});
---

<BaseLayout
  title="Minecraft Gilde - Server Infos"
  canonical={canonicalUrl}
  description="Serverinfos der Minecraft Gilde \u2013 Folia 1.21.x, Einstellungen, Plugins & Hardware. Vanilla SMP (DE) f\u00fcr Freebuild & Survival ohne Minigames."
>
  <JsonLd slot="head" data={gameServerLd} />
  <JsonLd slot="head" data={articleLd} />
  <section class="mg-container pt-12 pb-6">
    <div class="flex flex-col gap-4 sm:flex-row sm:items-end sm:justify-between">
      <div>
        <h1 class="text-3xl font-semibold tracking-tight">Serverinfos</h1>
        <p class="text-muted mt-2">
          Vanilla Survival &amp; Freebuild – optimiert, fair und ohne Resets.
        </p>
      </div>
      <div class="flex flex-wrap gap-2">
        <Button variant="primary" class="gap-2" data-copy-ip><Copy size={18} /> IP kopieren</Button>
        <Button href={DISCORD_URL} external variant="secondary" class="gap-2">
          Discord <ArrowRight size={18} />
        </Button>
        <Button href={DYNMAP_URL} external variant="ghost" class="gap-2"
          ><Map size={18} /> Dynmap</Button
        >
      </div>
    </div>

    <div class="mt-6 flex flex-wrap gap-2">
      <Badge variant="accent">{MC_VERSION}</Badge>
      <Badge>Folia (Paper Fork)</Badge>
      <Badge>Ohne Resets</Badge>
    </div>
  </section>

  <section class="mg-container pb-16">
    <div
      class="border-border/70 from-surface/40 to-surface/10 rounded-[var(--radius)] border bg-gradient-to-b p-6 sm:p-7"
    >
      <div class="grid gap-8 lg:grid-cols-3">
        <section class="lg:border-border/60 lg:border-r lg:pr-7">
          <div class="flex items-start gap-3">
            <Gamepad2 size={20} />
            <h2 class="text-base font-semibold">Kurzprofil</h2>
          </div>
          <dl class="mt-3 grid gap-2 text-sm">
            <div class="flex items-center justify-between gap-4">
              <dt class="text-muted">IP</dt><dd class="font-semibold">{SERVER_IP}</dd>
            </div>
            <div class="flex items-center justify-between gap-4">
              <dt class="text-muted">Version</dt><dd>Folia 1.21.11</dd>
            </div>
            <div class="flex items-center justify-between gap-4">
              <dt class="text-muted">Typ</dt><dd>Vanilla SMP (DE)</dd>
            </div>
            <div class="flex items-center justify-between gap-4">
              <dt class="text-muted">Welt</dt><dd>seit Feb 2024</dd>
            </div>
          </dl>
        </section>

        <section class="lg:border-border/60 lg:border-r lg:px-7">
          <div class="flex items-start gap-3">
            <Cpu size={20} />
            <h2 class="text-base font-semibold">Technik</h2>
          </div>
          <ul class="text-muted mt-3 space-y-2 text-sm">
            <li>
              <span class="text-fg/90 font-medium">CPU:</span> 2x Intel Xeon E5-2680 v2 (20 Kerne / 40
              Threads)
            </li>
            <li><span class="text-fg/90 font-medium">RAM:</span> 128 GB DDR3 ECC</li>
            <li><span class="text-fg/90 font-medium">Storage:</span> 500 GB SSD</li>
            <li><span class="text-fg/90 font-medium">OS:</span> Ubuntu 24.04</li>
            <li><span class="text-fg/90 font-medium">DB:</span> MariaDB (für Statistiken)</li>
            <li><span class="text-fg/90 font-medium">GC:</span> G1GC</li>
          </ul>
        </section>

        <section class="lg:pl-7">
          <div class="flex items-start gap-3">
            <Shield size={20} />
            <h2 class="text-base font-semibold">Gameplay &amp; Schutz</h2>
          </div>
          <ul class="text-muted mt-3 space-y-2 text-sm">
            <li>16 Chunks Sichtweite</li>
            <li>Vanilla-nahe Spawnraten</li>
            <li>Keine künstlichen Einschränkungen bei Mobs, Villagern oder Farmen</li>
            <li>Grundstücke lassen sich selbst schützen (GriefPrevention)</li>
            <li>Keine kaufbaren Ränge oder Items</li>
          </ul>
          <div class="mt-4 flex flex-wrap gap-2">
            <Button href="/tutorial" variant="secondary">Tutorial</Button>
            <Button href="/regeln" variant="ghost">Regeln</Button>
          </div>
        </section>
      </div>
    </div>

    <div class="mt-6 grid gap-6 lg:grid-cols-[1.08fr_0.92fr] lg:items-stretch">
      <article class="border-border/70 bg-surface/40 h-full rounded-[var(--radius)] border p-6">
        <h2 class="text-xl font-semibold tracking-tight">Warum Folia?</h2>
        <p class="text-muted mt-3 text-sm leading-relaxed">
          Das Server-System ist seit Mai 2025 auf Folia umgestellt – ein Paper-Fork, der die
          Minecraft-Welt in Regionen aufteilt und diese parallel abarbeitet. Dadurch kann der Server
          viele Spieler gleichzeitig flüssiger bedienen.
        </p>
        <p class="text-muted mt-3 text-sm leading-relaxed">
          Wie stabil Folia läuft? Inzwischen sehr gut. Einzelne Plugins können (selten) noch
          Probleme machen – insgesamt ist das Setup aber alltagstauglich.
        </p>
      </article>

      <figure
        class="border-border/70 bg-surface/25 h-full rounded-[var(--radius)] border p-5 sm:p-6"
      >
        <img
          src="/images/folia.webp"
          alt="Folia Logo"
          width="600"
          height="320"
          loading="lazy"
          class="mx-auto w-full max-w-[18rem] sm:max-w-[20rem] md:max-w-[22rem]"
        />
        <figcaption class="text-muted mt-4 text-center text-sm">
          Folia ist ein Fork von PaperMC und bietet einen Multithreaded-Ansatz.
        </figcaption>
      </figure>
    </div>
    <Callout variant="info" class="mt-6">
      <p>
        Du willst direkt loslegen? Dann schau kurz in den Tutorial – dort findest du Claim, RTP,
        Rollen und alles Wichtige.
      </p>
      <div class="mt-3">
        <Button href="/tutorial" variant="primary">Zum Tutorial</Button>
      </div>
    </Callout>
  </section>
</BaseLayout>
