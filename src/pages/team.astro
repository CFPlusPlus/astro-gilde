---
import BaseLayout from '../layouts/BaseLayout.astro';
import Card from '../components/ui/Card.astro';
import Button from '../components/ui/Button.astro';
import Badge from '../components/ui/Badge.astro';
import { TEAM_GROUPS, TEAM_MEMBERS } from '../data/team';
import { Shield, ArrowRight } from '@lucide/astro';
import { minecraftGilde } from '../config/minecraftGilde';

const DISCORD_URL = minecraftGilde.discord.url;

const avatarUrl = (name: string) => `https://minotar.net/helm/${encodeURIComponent(name)}/96.png`;

const groups = TEAM_GROUPS.map((g) => ({
  ...g,
  members: TEAM_MEMBERS.filter((m) => m.group === g.key),
})).filter((g) => g.members.length > 0);
---

<BaseLayout
  title="Minecraft Gilde - Unser Team"
  description="Lerne das Minecraft Gilde Serverteam kennen – erfahrene Admins und hilfsbereite Moderatoren für dein optimales Freebuild & Survival Erlebnis auf unserem deutschen Minecraft-Server."
>
  <section class="mg-container pt-12 pb-6">
    <div>
      <h1 class="text-3xl font-semibold tracking-tight">Team</h1>
      <p class="text-muted mt-2">Hier findest du das engagierte Team der Minecraft Gilde.</p>
    </div>

    <div class="mt-6 flex flex-wrap gap-3">
      <Button href={DISCORD_URL} external variant="primary" class="gap-2">
        Discord <ArrowRight size={18} />
      </Button>
      <Button href="/tutorial" variant="secondary">Tutorial</Button>
      <Button href="/regeln" variant="ghost">Regeln</Button>
    </div>
  </section>

  <section class="mg-container pb-16">
    <div class="grid gap-4">
      {
        groups.map((g) => (
          <Card class="p-6">
            <div class="flex items-center justify-between gap-4">
              <div class="inline-flex items-center gap-2">
                <Shield size={18} />
                <h2 class="text-xl font-semibold tracking-tight">{g.label}</h2>
              </div>
              <Badge variant="accent">{g.members.length}</Badge>
            </div>

            <div class="mt-4 grid gap-3 sm:grid-cols-2 lg:grid-cols-3">
              {g.members.map((m) => (
                <div class="mg-card flex items-center gap-3 p-4">
                  <img
                    src={avatarUrl(m.inGameName)}
                    alt={m.inGameName}
                    width="48"
                    height="48"
                    loading="lazy"
                    decoding="async"
                    class="border-border bg-surface h-12 w-12 rounded-full border"
                  />
                  <div class="min-w-0">
                    <div class="text-sm font-semibold">{m.inGameName}</div>
                    <div class="text-muted text-xs">{m.role}</div>
                  </div>
                </div>
              ))}
            </div>
          </Card>
        ))
      }
    </div>
  </section>
</BaseLayout>
