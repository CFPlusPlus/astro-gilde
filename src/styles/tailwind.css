@import 'tailwindcss';

/*
  Design-Tokens (klar + subtiler Glas-Look + minimal)
  - Auto Hell/Dunkel ueber prefers-color-scheme
  - Optionales manuelles Ueberschreiben via: html[data-theme="light|dark"]
  - Anthrazit (nicht reines Schwarz) + Gold-Akzent
*/

:root {
  /* Typografie */
  --font-sans:
    'Geist Variable', ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial,
    'Apple Color Emoji', 'Segoe UI Emoji';
  --font-display:
    'Space Grotesk Variable', ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica,
    Arial;

  /* Hell */
  --bg: #f7f8fb;
  --fg: #0f1826;
  --muted: #475569;

  --surface: rgba(255, 255, 255, 0.72);
  --surface-solid: #ffffff;
  --border: rgba(15, 23, 42, 0.1);
  --glass-highlight: rgba(255, 255, 255, 0.34);
  --glass-shadow: rgba(15, 23, 42, 0.12);

  --ambient-1: rgba(242, 201, 76, 0.4);
  --ambient-2: rgba(120, 176, 246, 0.34);
  --ambient-3: rgba(29, 44, 64, 0.22);

  --accent: #f2c94c;
  --accent2: #ffd56a;
  --ring: rgba(242, 201, 76, 0.45);
  --accent-dark: color-mix(in oklab, var(--accent) 85%, black 15%);
  --accent-soft: color-mix(in oklab, var(--accent) 18%, transparent);

  --radius: 16px;
}

@media (prefers-color-scheme: dark) {
  :root {
    /* Dunkel (Obsidian / Anthrazit) */
    --bg: #0d1219;
    --fg: #e7edf5;
    --muted: #a8b2c2;

    --surface: rgba(19, 25, 34, 0.56);
    --surface-solid: #131a25;
    --border: rgba(231, 237, 245, 0.16);
    --glass-highlight: rgba(255, 255, 255, 0.1);
    --glass-shadow: rgba(6, 10, 18, 0.52);

    --ambient-1: rgba(242, 201, 76, 0.34);
    --ambient-2: rgba(103, 125, 149, 0.28);
    --ambient-3: rgba(68, 84, 102, 0.22);

    --accent: #f2c94c;
    --accent2: #ffd56a;
    --ring: rgba(242, 201, 76, 0.3);
  }
}

/* Manueller Override (gesetzt durch den Theme-Toggle) */
html[data-theme='light'] {
  --bg: #f7f8fb;
  --fg: #0f172a;
  --muted: #475569;

  --surface: rgba(255, 255, 255, 0.72);
  --surface-solid: #ffffff;
  --border: rgba(15, 23, 42, 0.1);
  --glass-highlight: rgba(255, 255, 255, 0.34);
  --glass-shadow: rgba(15, 23, 42, 0.12);

  --ambient-1: rgba(242, 201, 76, 0.4);
  --ambient-2: rgba(120, 176, 246, 0.34);
  --ambient-3: rgba(29, 44, 64, 0.22);

  --accent: #f2c94c;
  --accent2: #ffd56a;
  --ring: rgba(242, 201, 76, 0.45);
}

html[data-theme='dark'] {
  --bg: #0d1219;
  --fg: #e7edf5;
  --muted: #a8b2c2;

  --surface: rgba(19, 25, 34, 0.56);
  --surface-solid: #131a25;
  --border: rgba(231, 237, 245, 0.16);
  --glass-highlight: rgba(255, 255, 255, 0.1);
  --glass-shadow: rgba(6, 10, 18, 0.52);

  --ambient-1: rgba(242, 201, 76, 0.34);
  --ambient-2: rgba(103, 125, 149, 0.28);
  --ambient-3: rgba(68, 84, 102, 0.22);

  --accent: #f2c94c;
  --accent2: #ffd56a;
  --ring: rgba(242, 201, 76, 0.3);
}

/* Tokens in Tailwind v4 CSS-first Theme-Variablen spiegeln */
@theme {
  --font-sans: var(--font-sans);
  --font-display: var(--font-display);

  --color-bg: var(--bg);
  --color-fg: var(--fg);
  --color-muted: var(--muted);

  --color-surface: var(--surface);
  --color-surface-solid: var(--surface-solid);
  --color-border: var(--border);

  --color-accent: var(--accent);
  --color-accent2: var(--accent2);
  --color-ring: var(--ring);

  --radius-lg: var(--radius);
}

@layer base {
  html {
    /* UA kann Controls passend rendern, wir ueberschreiben das
       aber im manuellen Theme-Modus (siehe unten). */
    background: var(--bg);
    color-scheme: light dark;
    scrollbar-gutter: stable;
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* Wenn das Mobile-Menue offen ist, nur den Inhalt blurrieren (nicht die Navbar). */
  html[data-menu-open='1'] main {
    filter: blur(12px);
    transform: translateZ(0);
  }

  /* Wenn der Nutzer das Theme erzwingt, auch das UA color-scheme setzen.
     Das behebt z. B. falsche Farben bei nativen Clear-Buttons. */
  html[data-theme='light'] {
    color-scheme: light;
  }

  html[data-theme='dark'] {
    color-scheme: dark;
  }

  @media (prefers-color-scheme: dark) {
    html:not([data-theme]) {
      color-scheme: dark;
    }
  }

  @media (prefers-color-scheme: light) {
    html:not([data-theme]) {
      color-scheme: light;
    }
  }

  body {
    font-family: var(--font-sans);
  }

  h1,
  h2,
  h3,
  h4 {
    font-family: var(--font-display);
    letter-spacing: -0.02em;
  }

  :focus-visible {
    outline: none;
  }

  /* Native Search-Clear-Buttons ausblenden (wir nutzen eigene Reset-Buttons). */
  input[type='search']::-webkit-search-cancel-button {
    -webkit-appearance: none;
    appearance: none;
    display: none;
  }

  input[type='search']::-ms-clear {
    display: none;
    width: 0;
    height: 0;
  }

  /* Link-Standards */
  a {
    text-decoration-thickness: 1px;
    text-underline-offset: 3px;
  }

  code,
  kbd {
    font-family:
      ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New',
      monospace;
  }

  code {
    background: color-mix(in oklab, var(--surface-solid) 70%, transparent);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 0.12rem 0.45rem;
  }

  kbd {
    background: color-mix(in oklab, var(--surface-solid) 70%, transparent);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 0.12rem 0.45rem;
    box-shadow: 0 1px 0 color-mix(in oklab, var(--fg) 10%, transparent);
  }
}

@layer utilities {
  .mg-page-bg {
    position: relative;
    isolation: isolate;
    background:
      radial-gradient(128% 82% at 50% -22%, var(--ambient-1) 0%, transparent 61%),
      radial-gradient(88% 70% at 112% 14%, var(--ambient-2) 0%, transparent 64%),
      radial-gradient(76% 62% at -16% 88%, var(--ambient-3) 0%, transparent 61%),
      radial-gradient(
        60% 48% at 22% 28%,
        color-mix(in oklab, var(--accent) 14%, var(--ambient-1) 86%) 0%,
        transparent 74%
      ),
      radial-gradient(
        54% 42% at 78% 66%,
        color-mix(in oklab, var(--accent2) 10%, var(--ambient-2) 90%) 0%,
        transparent 76%
      ),
      linear-gradient(
        180deg,
        color-mix(in oklab, var(--bg) 58%, var(--ambient-2) 42%) 0%,
        color-mix(in oklab, var(--bg) 82%, var(--ambient-1) 18%) 44%,
        var(--bg) 100%
      );
  }

  .mg-page-bg::before {
    content: '';
    position: absolute;
    inset: 0;
    background:
      linear-gradient(
        to right,
        color-mix(in oklab, var(--fg) 8%, transparent) 1px,
        transparent 1px
      ),
      linear-gradient(
        to bottom,
        color-mix(in oklab, var(--fg) 7%, transparent) 1px,
        transparent 1px
      );
    background-size: 130px 130px;
    mask-image: radial-gradient(100% 65% at 50% 0%, black 0%, transparent 100%);
    opacity: 0.2;
  }

  .mg-page-bg::after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(
      to bottom,
      transparent 0%,
      color-mix(in oklab, var(--bg) 70%, black 30%) 100%
    );
    opacity: 0.2;
  }

  /* Dezenter Glas-Helfer */
  .glass {
    background: color-mix(in oklab, var(--surface) 90%, transparent);
    border: 1px solid color-mix(in oklab, var(--border) 92%, white 8%);
    box-shadow:
      inset 0 1px 0 color-mix(in oklab, var(--glass-highlight) 70%, transparent),
      0 12px 28px -24px var(--glass-shadow);
    -webkit-backdrop-filter: blur(14px) saturate(120%);
    backdrop-filter: blur(14px) saturate(120%);
  }

  /* Staerkerer Glas-Look (z. B. Overlay / Mobile-Navigation) */
  .glass-strong {
    background: color-mix(in oklab, var(--surface-solid) 86%, transparent);
    border: 1px solid color-mix(in oklab, var(--border) 92%, white 8%);
    box-shadow:
      inset 0 1px 0 color-mix(in oklab, var(--glass-highlight) 70%, transparent),
      0 22px 46px -30px var(--glass-shadow);
    -webkit-backdrop-filter: blur(24px) saturate(130%);
    backdrop-filter: blur(24px) saturate(130%);
  }

  /* Top-Navigation: Akzent aktiv + animierte Unterstreichung beim Hover */
  .site-nav-link {
    position: relative;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0.5rem 0.75rem;
    font-size: 0.875rem;
    font-weight: 600;
    color: color-mix(in oklab, var(--fg) 88%, transparent);
    transition: color 150ms ease;
  }

  .site-nav-link::after {
    content: '';
    position: absolute;
    left: 50%;
    bottom: -0.02rem;
    width: 50%;
    height: 3px;
    border-radius: 999px;
    background: color-mix(in oklab, var(--fg) 85%, transparent);
    opacity: 0;
    transform: translateX(-50%) scaleX(0);
    transform-origin: center;
    transition:
      transform 180ms ease,
      opacity 180ms ease,
      background-color 180ms ease;
  }

  .site-nav-link:hover {
    color: var(--fg);
  }

  .site-nav-link:hover::after {
    opacity: 1;
    transform: translateX(-50%) scaleX(1);
  }

  .site-nav-link.is-active {
    color: var(--accent);
  }

  .site-nav-link.is-active::after {
    opacity: 1;
    transform: translateX(-50%) scaleX(1);
    background: var(--accent);
  }

  .site-nav-link:focus-visible {
    outline: 2px solid var(--ring);
    outline-offset: 4px;
    border-radius: 999px;
  }

  /* Projekt-Designsystem-Aliasse ("mg" = Minecraft Gilde). */
  .mg-container {
    @apply mx-auto max-w-6xl px-4;
  }

  .mg-section {
    @apply py-10;
  }

  .mg-card {
    @apply bg-surface border-border rounded-[var(--radius)] border shadow-sm backdrop-blur-md;
  }

  .mg-muted {
    color: var(--muted);
  }

  .mg-prose {
    line-height: 1.75;
  }

  .mg-prose h2 {
    font-size: 1.25rem;
    margin-top: 1.75rem;
    margin-bottom: 0.75rem;
  }

  .mg-prose h3 {
    font-size: 1.05rem;
    margin-top: 1.25rem;
    margin-bottom: 0.5rem;
  }

  .mg-prose p {
    margin: 0.75rem 0;
    color: color-mix(in oklab, var(--fg) 92%, transparent);
  }

  .mg-prose ul,
  .mg-prose ol {
    margin: 0.75rem 0;
    padding-left: 1.25rem;
    color: color-mix(in oklab, var(--fg) 92%, transparent);
  }

  .mg-prose li {
    margin: 0.35rem 0;
  }

  .mg-prose a,
  a.mg-link {
    color: color-mix(in oklab, var(--accent) 85%, var(--fg) 15%);
    text-decoration: underline;
    text-decoration-color: color-mix(in oklab, var(--accent) 45%, transparent);
    transition:
      color 150ms ease,
      text-decoration-color 150ms ease;
  }

  .mg-prose a:hover,
  a.mg-link:hover {
    color: color-mix(in oklab, var(--accent2) 92%, var(--fg) 8%);
    text-decoration-color: color-mix(in oklab, var(--accent) 70%, transparent);
  }

  .mg-prose a:focus-visible,
  a.mg-link:focus-visible {
    outline: 2px solid var(--ring);
    outline-offset: 3px;
    border-radius: 8px;
  }

  /* Akkordeon */
  .mg-accordion {
    @apply bg-surface border-border rounded-[var(--radius)] border p-4 shadow-sm backdrop-blur-md;
  }

  .mg-accordion summary {
    list-style: none;
    cursor: pointer;
    user-select: none;
  }

  .mg-accordion summary::-webkit-details-marker {
    display: none;
  }

  .mg-accordion[open] {
    box-shadow: 0 12px 30px color-mix(in oklab, var(--fg) 12%, transparent);
  }

  /* Einfaches Callout */
  .mg-callout {
    /* An das "Glass-Card"-Design anlehnen: einheitlicher Border, weicher Schatten, gut lesbar. */
    @apply bg-surface border-border rounded-[var(--radius)] border p-4 shadow-sm backdrop-blur-md;
  }

  .mg-callout__icon {
    @apply bg-accent/15 text-accent mt-0.5 flex h-9 w-9 shrink-0 items-center justify-center rounded-xl;
  }

  .mg-callout[data-variant='warning'] .mg-callout__icon {
    @apply bg-accent/20;
  }

  .mg-callout[data-variant='warning'] {
    border-color: color-mix(in oklab, var(--accent) 60%, var(--border) 40%);
    background: color-mix(in oklab, var(--accent) 10%, var(--surface) 90%);
  }

  .mg-callout[data-variant='info'] {
    border-color: color-mix(in oklab, var(--accent) 18%, var(--border) 82%);
    background: color-mix(in oklab, var(--surface) 85%, transparent);
  }

  /* Ranglisten: Medaillen fuer Platz 1-3 (minimalistisch) */
  .mg-rank-medal {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 1.5rem;
    height: 1.5rem;
    border-radius: 999px;
    border: 1px solid color-mix(in oklab, var(--fg) 14%, var(--border) 86%);
    background: color-mix(in oklab, var(--surface-solid) 92%, transparent);
    font-size: 0.7rem;
    font-weight: 700;
    line-height: 1;
    letter-spacing: -0.02em;
    box-shadow: inset 0 0 0 1px color-mix(in oklab, var(--fg) 4%, transparent);
  }

  .mg-rank-medal--1 {
    background: color-mix(in oklab, var(--accent) 22%, var(--surface-solid) 78%);
    border-color: color-mix(in oklab, var(--accent) 55%, var(--border) 45%);
    color: color-mix(in oklab, var(--accent) 80%, var(--fg) 20%);
  }

  .mg-rank-medal--2 {
    background: color-mix(in oklab, var(--fg) 6%, var(--surface-solid) 94%);
    border-color: color-mix(in oklab, var(--fg) 18%, var(--border) 82%);
    color: color-mix(in oklab, var(--fg) 80%, var(--muted) 20%);
  }

  .mg-rank-medal--3 {
    background: color-mix(in oklab, #d99a6c 18%, var(--surface-solid) 82%);
    border-color: color-mix(in oklab, #d99a6c 50%, var(--border) 50%);
    color: color-mix(in oklab, #9a5d3a 80%, var(--fg) 20%);
  }

  /* Schlankere Scrollbar fuer kompakte Listen (Ranglisten/Versus Picker). */
  .mg-scrollbar-thin {
    scrollbar-width: thin;
    scrollbar-color: color-mix(in oklab, var(--muted) 36%, transparent) transparent;
  }

  .mg-scrollbar-thin::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  .mg-scrollbar-thin::-webkit-scrollbar-track {
    background: transparent;
  }

  .mg-scrollbar-thin::-webkit-scrollbar-thumb {
    background: color-mix(in oklab, var(--muted) 34%, transparent);
    border-radius: 999px;
    border: 2px solid transparent;
    background-clip: padding-box;
  }

  .mg-scrollbar-thin::-webkit-scrollbar-thumb:hover {
    background: color-mix(in oklab, var(--accent) 52%, var(--muted) 48%);
    border: 2px solid transparent;
    background-clip: padding-box;
  }

  /* Einheitlicher Reset-Button fuer Suchfelder */
  .mg-search-clear {
    @apply text-muted hover:text-fg inline-flex h-6 w-6 flex-none items-center justify-center rounded-md transition-colors;
  }

  .mg-search-clear--hidden {
    @apply pointer-events-none opacity-0;
  }
}
