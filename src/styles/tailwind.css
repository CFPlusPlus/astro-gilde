@import 'tailwindcss';

/*
  v2 Design-Tokens (klar + subtiler Glas-Look + minimal)
  - Auto Hell/Dunkel ueber prefers-color-scheme
  - Optionales manuelles Ueberschreiben via: html[data-theme="light|dark"]
  - Anthrazit (nicht reines Schwarz) + Gold-Akzent
*/

:root {
  /* Typografie */
  --font-sans:
    'Geist Variable', ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial,
    'Apple Color Emoji', 'Segoe UI Emoji';
  --font-display:
    'Space Grotesk Variable', ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica,
    Arial;

  /* Hell */
  --bg: #f7f8fb;
  --fg: #0f1826;
  --muted: #475569;

  --surface: rgba(255, 255, 255, 0.72);
  --surface-solid: #ffffff;
  --border: rgba(15, 23, 42, 0.1);

  --accent: #f2c94c;
  --accent2: #ffd56a;
  --ring: rgba(242, 201, 76, 0.45);
  --accent-dark: color-mix(in oklab, var(--accent) 85%, black 15%);
  --accent-soft: color-mix(in oklab, var(--accent) 18%, transparent);

  --radius: 16px;
}

@media (prefers-color-scheme: dark) {
  :root {
    /* Dunkel (Obsidian / Anthrazit) */
    --bg: #0b0f14;
    --fg: #e5e7eb;
    --muted: #a1a1aa;

    --surface: rgba(17, 21, 27, 0.6);
    --surface-solid: #11151b;
    --border: rgba(255, 255, 255, 0.1);

    --accent: #f2c94c;
    --accent2: #ffd56a;
    --ring: rgba(242, 201, 76, 0.3);
  }
}

/* Manueller Override (gesetzt durch den v2 Theme-Toggle) */
html[data-theme='light'] {
  --bg: #f7f8fb;
  --fg: #0f172a;
  --muted: #475569;

  --surface: rgba(255, 255, 255, 0.72);
  --surface-solid: #ffffff;
  --border: rgba(15, 23, 42, 0.1);

  --accent: #f2c94c;
  --accent2: #ffd56a;
  --ring: rgba(242, 201, 76, 0.45);
}

html[data-theme='dark'] {
  --bg: #0b0f14;
  --fg: #e5e7eb;
  --muted: #a1a1aa;

  --surface: rgba(17, 21, 27, 0.6);
  --surface-solid: #11151b;
  --border: rgba(255, 255, 255, 0.1);

  --accent: #f2c94c;
  --accent2: #ffd56a;
  --ring: rgba(242, 201, 76, 0.3);
}

/* Tokens in Tailwind v4 CSS-first Theme-Variablen spiegeln */
@theme {
  --font-sans: var(--font-sans);
  --font-display: var(--font-display);

  --color-bg: var(--bg);
  --color-fg: var(--fg);
  --color-muted: var(--muted);

  --color-surface: var(--surface);
  --color-surface-solid: var(--surface-solid);
  --color-border: var(--border);

  --color-accent: var(--accent);
  --color-accent2: var(--accent2);
  --color-ring: var(--ring);

  --radius-lg: var(--radius);
}

@layer base {
  html {
    /* UA kann Controls passend rendern, wir ueberschreiben das
       aber im manuellen Theme-Modus (siehe unten). */
    color-scheme: light dark;
    scrollbar-gutter: stable;
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* Wenn das Mobile-Menue offen ist, nur den Inhalt blurrieren (nicht die Navbar). */
  html[data-menu-open='1'] main {
    filter: blur(12px);
    transform: translateZ(0);
  }

  /* Wenn der Nutzer das Theme erzwingt, auch das UA color-scheme setzen.
     Das behebt z. B. falsche Farben bei nativen Clear-Buttons. */
  html[data-theme='light'] {
    color-scheme: light;
  }

  html[data-theme='dark'] {
    color-scheme: dark;
  }

  @media (prefers-color-scheme: dark) {
    html:not([data-theme]) {
      color-scheme: dark;
    }
  }

  @media (prefers-color-scheme: light) {
    html:not([data-theme]) {
      color-scheme: light;
    }
  }

  body {
    font-family: var(--font-sans);
  }

  h1,
  h2,
  h3,
  h4 {
    font-family: var(--font-display);
    letter-spacing: -0.02em;
  }

  :focus-visible {
    outline: none;
  }

  /* Link-Standards */
  a {
    text-decoration-thickness: 1px;
    text-underline-offset: 3px;
  }

  code,
  kbd {
    font-family:
      ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New',
      monospace;
  }

  code {
    background: color-mix(in oklab, var(--surface-solid) 70%, transparent);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 0.12rem 0.45rem;
  }

  kbd {
    background: color-mix(in oklab, var(--surface-solid) 70%, transparent);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 0.12rem 0.45rem;
    box-shadow: 0 1px 0 color-mix(in oklab, var(--fg) 10%, transparent);
  }
}

@layer utilities {
  /* Dezenter Glas-Helfer */
  .glass {
    background: var(--surface);
    border: 1px solid var(--border);
    backdrop-filter: blur(12px);
  }

  /* Staerkerer Glas-Look (z. B. Overlay / Mobile-Navigation) */
  .glass-strong {
    background: color-mix(in oklab, var(--surface-solid) 94%, transparent);
    border: 1px solid var(--border);
    backdrop-filter: blur(24px);
  }

  /* Top-Navigation: Akzent aktiv + animierte Unterstreichung beim Hover */
  .site-nav-link {
    position: relative;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0.5rem 0.75rem;
    font-size: 0.875rem;
    font-weight: 600;
    color: color-mix(in oklab, var(--fg) 88%, transparent);
    transition: color 150ms ease;
  }

  .site-nav-link::after {
    content: '';
    position: absolute;
    left: 50%;
    bottom: -0.02rem;
    width: 50%;
    height: 3px;
    border-radius: 999px;
    background: color-mix(in oklab, var(--fg) 85%, transparent);
    opacity: 0;
    transform: translateX(-50%) scaleX(0);
    transform-origin: center;
    transition:
      transform 180ms ease,
      opacity 180ms ease,
      background-color 180ms ease;
  }

  .site-nav-link:hover {
    color: var(--fg);
  }

  .site-nav-link:hover::after {
    opacity: 1;
    transform: translateX(-50%) scaleX(1);
  }

  .site-nav-link.is-active {
    color: var(--accent);
  }

  .site-nav-link.is-active::after {
    opacity: 1;
    transform: translateX(-50%) scaleX(1);
    background: var(--accent);
  }

  .site-nav-link:focus-visible {
    outline: 2px solid var(--ring);
    outline-offset: 4px;
    border-radius: 999px;
  }

  /* Projekt-Designsystem-Aliasse ("mg" = Minecraft Gilde). */
  .mg-container {
    @apply mx-auto max-w-6xl px-4;
  }

  .mg-section {
    @apply py-10;
  }

  .mg-card {
    @apply bg-surface border-border rounded-[var(--radius)] border shadow-sm backdrop-blur-md;
  }

  .mg-muted {
    color: var(--muted);
  }

  .mg-prose {
    line-height: 1.75;
  }

  .v2-container {
    @apply mx-auto max-w-6xl px-4;
  }

  .v2-section {
    @apply py-10;
  }

  .v2-card {
    @apply bg-surface border-border rounded-[var(--radius)] border shadow-sm backdrop-blur-md;
  }

  .v2-muted {
    color: var(--muted);
  }

  .v2-prose,
  .mg-prose {
    line-height: 1.75;
  }

  .v2-prose h2,
  .mg-prose h2 {
    font-size: 1.25rem;
    margin-top: 1.75rem;
    margin-bottom: 0.75rem;
  }

  .v2-prose h3,
  .mg-prose h3 {
    font-size: 1.05rem;
    margin-top: 1.25rem;
    margin-bottom: 0.5rem;
  }

  .v2-prose p,
  .mg-prose p {
    margin: 0.75rem 0;
    color: color-mix(in oklab, var(--fg) 92%, transparent);
  }

  .v2-prose ul,
  .v2-prose ol,
  .mg-prose ul,
  .mg-prose ol {
    margin: 0.75rem 0;
    padding-left: 1.25rem;
    color: color-mix(in oklab, var(--fg) 92%, transparent);
  }

  .v2-prose li,
  .mg-prose li {
    margin: 0.35rem 0;
  }

  .v2-prose a,
  .mg-prose a,
  a.mg-link {
    color: color-mix(in oklab, var(--accent) 85%, var(--fg) 15%);
    text-decoration: underline;
    text-decoration-color: color-mix(in oklab, var(--accent) 45%, transparent);
    transition:
      color 150ms ease,
      text-decoration-color 150ms ease;
  }

  .v2-prose a:hover,
  .mg-prose a:hover,
  a.mg-link:hover {
    color: color-mix(in oklab, var(--accent2) 92%, var(--fg) 8%);
    text-decoration-color: color-mix(in oklab, var(--accent) 70%, transparent);
  }

  .v2-prose a:focus-visible,
  .mg-prose a:focus-visible,
  a.mg-link:focus-visible {
    outline: 2px solid var(--ring);
    outline-offset: 3px;
    border-radius: 8px;
  }

  /* Akkordeon */
  .v2-accordion,
  .mg-accordion {
    @apply bg-surface border-border rounded-[var(--radius)] border p-4 shadow-sm backdrop-blur-md;
  }

  .v2-accordion summary,
  .mg-accordion summary {
    list-style: none;
    cursor: pointer;
    user-select: none;
  }

  .v2-accordion summary::-webkit-details-marker,
  .mg-accordion summary::-webkit-details-marker {
    display: none;
  }

  .v2-accordion[open],
  .mg-accordion[open] {
    box-shadow: 0 12px 30px color-mix(in oklab, var(--fg) 12%, transparent);
  }

  /* Einfaches Callout */
  .v2-callout,
  .mg-callout {
    /* An das "Glass-Card"-Design anlehnen: einheitlicher Border, weicher Schatten, gut lesbar. */
    @apply bg-surface border-border rounded-[var(--radius)] border p-4 shadow-sm backdrop-blur-md;
  }

  .mg-callout__icon {
    @apply bg-accent/15 text-accent mt-0.5 flex h-9 w-9 shrink-0 items-center justify-center rounded-xl;
  }

  .mg-callout[data-variant='warning'] .mg-callout__icon {
    @apply bg-accent/20;
  }

  .v2-callout[data-variant='warning'],
  .mg-callout[data-variant='warning'] {
    border-color: color-mix(in oklab, var(--accent) 60%, var(--border) 40%);
    background: color-mix(in oklab, var(--accent) 10%, var(--surface) 90%);
  }

  .v2-callout[data-variant='info'],
  .mg-callout[data-variant='info'] {
    border-color: color-mix(in oklab, var(--accent) 18%, var(--border) 82%);
    background: color-mix(in oklab, var(--surface) 85%, transparent);
  }
}
